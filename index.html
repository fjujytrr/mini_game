<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no">
<title>Hide & Seek ‚Äî Premium Emoji</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: 'Inter', sans-serif;
  background: linear-gradient(120deg, #2b1055, #7597de);
  background-size: 200% 200%;
  animation: gradientBG 15s ease infinite;
  overflow: hidden;
  color: #ffffff;
}
@keyframes gradientBG {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
body {
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}
header {
  width: 95%;
  margin: 15px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(0, 0, 0, 0.4);
  border-radius: 12px;
  padding: 10px;
  backdrop-filter: blur(5px);
}
.level-bar {
  display: flex;
  gap: 6px;
  background: rgba(0, 0, 0, 0.4);
  padding: 6px 10px;
  border-radius: 12px;
  flex: 1;
  justify-content: space-between;
}
.level {
  flex: 1;
  text-align: center;
  padding: 6px 0;
  font-size: 14px;
  font-weight: 700;
  color: #aaa;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.1);
  transition: 0.5s;
  cursor: pointer;
}
.level.active {
  background: #00D8FF;
  color: #000;
  box-shadow: 0 0 8px #00D8FF;
}
.coin-panel {
  display: flex;
  align-items: center;
  gap: 8px;
  background: rgba(0, 0, 0, 0.4);
  padding: 8px 16px;
  border-radius: 16px;
  box-shadow: 0 0 12px rgba(0,216,255,0.4);
}
.coin-panel .val {
  font-weight: 700;
  font-size: 18px;
  color: #00D8FF;
}
.house {
  position: relative;
  width: 95%;
  max-width: 500px;
  margin: 20px 0;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: repeat(4, 1fr);
  gap: 12px;
}
.room {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 28px;
  color: #ddd;
  cursor: pointer;
  transition: transform 0.3s, box-shadow 0.3s;
  position: relative;
  border: 2px solid rgba(255, 255, 255, 0.2);
}
.room:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px #00D8FF;
}
.room.selected {
  border-color: #00D8FF;
  box-shadow: 0 0 10px #00D8FF;
}
.room.found {
  border-color: #FF0054;
  box-shadow: 0 0 12px #FF0054;
  animation: foundAnim 1s ease;
}
.room.safe {
  border-color: #39FF14;
  box-shadow: 0 0 12px #39FF14;
  animation: safeAnim 0.8s ease;
}
.room.highlight {
  box-shadow: 0 0 20px 4px #00D8FF;
  transition: box-shadow 0.3s;
}
@keyframes foundAnim {
  0% { transform: scale(1); }
  50% { transform: rotate(10deg) scale(1.15); }
  100% { transform: scale(1); }
}
@keyframes safeAnim {
  0% { transform: scale(1); }
  50% { transform: rotate(-10deg) scale(0.9); }
  100% { transform: scale(1); }
}
.controls {
  width: 90%;
  display: flex;
  justify-content: space-between;
  margin-bottom: 15px;
}
button {
  flex: 1;
  margin: 0 5px;
  padding: 14px;
  font-size: 20px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  color: #000;
  background: #00D8FF;
  box-shadow: 0 4px 12px rgba(0,216,255,0.4);
  transition: transform 0.2s, box-shadow 0.2s;
}
button:active {
  transform: scale(0.98);
  box-shadow: 0 2px 6px rgba(0,216,255,0.3);
}
button.secondary {
  background: #222;
  color: #fff;
  border: 1px solid #00D8FF;
  box-shadow: 0 3px 8px rgba(0,216,255,0.2);
}
.bottom-menu {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  max-width: 480px;
  display: flex;
  justify-content: space-around;
  gap: 8px;
  background: rgba(0, 0, 0, 0.5);
  padding: 6px 0;
  border-radius: 16px;
  backdrop-filter: blur(5px);
  box-shadow: 0 0 12px rgba(0,216,255,0.3);
}
.bottom-menu button {
  background: transparent;
  color: #fff;
  font-size: 22px;
  transition: transform 0.2s;
}
.bottom-menu button:hover {
  transform: scale(1.2);
  color: #00D8FF;
}
.upgrade-panel {
  display: none;
  gap: 12px;
  margin: 10px 0;
  overflow-x: auto;
  padding: 10px;
  width: 95%;
}
.upgrade {
  flex: 0 0 auto;
  background: rgba(0,0,0,0.4);
  padding: 12px;
  border-radius: 14px;
  text-align: center;
  min-width: 150px;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(0,216,255,0.2);
}
.upgrade h3 {
  margin: 0 0 6px;
  font-size: 16px;
  color: #00D8FF;
}
.upgrade p {
  margin: 0;
  font-size: 14px;
  color: #ccc;
}
.upgrade .price {
  margin-top: 6px;
  font-weight: 700;
  color: #00D8FF;
}
.upgrade .timer {
  margin-top: 4px;
  font-size: 12px;
  color: #00D8FF;
}
.mining-info {
  margin: 10px 0;
  padding: 10px 12px;
  background: rgba(0,0,0,0.4);
  border-radius: 14px;
  width: 95%;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,216,255,0.2);
}
#miningShop {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 500px;
  background: rgba(0,0,0,0.6);
  border: 2px solid #00D8FF;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 0 20px #00D8FF;
  z-index: 200;
  overflow-y: auto;
  max-height: 80vh;
}
#miningShop h2 {
  color: #00D8FF;
  text-align: center;
  margin-bottom: 12px;
}
.miners-container {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
}
.miner-card {
  background: rgba(255,255,255,0.05);
  color: #fff;
  border-radius: 14px;
  padding: 14px;
  width: 45%;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.5);
  cursor: pointer;
  transition: transform 0.3s, box-shadow 0.3s;
}
.miner-card:hover {
  transform: translateY(-5px) scale(1.05);
  box-shadow: 0 6px 18px #00D8FF;
}
.miner-card h3 {
  margin: 0;
  font-size: 16px;
  color: #fff;
  text-align: center;
}
.miner-card .income {
  font-size: 14px;
  color: #ccc;
}
.miner-card .income-val {
  color: #39FF14;
  font-weight: 700;
}
.miner-card .bottom {
  display: flex;
  justify-content: space-between;
  width: 100%;
  font-weight: 700;
  font-size: 14px;
  margin-top: 6px;
}
.miner-card .lvl {
  color: #00D8FF;
}
.miner-card .price {
  color: #00D8FF;
}
#buyConfirm {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0,0,0,0.6);
  border: 2px solid #00D8FF;
  border-radius: 16px;
  padding: 20px;
  text-align: center;
  box-shadow: 0 0 20px #00D8FF;
  z-index: 300;
  opacity: 0;
  transition: 0.3s;
}
#buyConfirm.show {
  display: block;
  opacity: 1;
}
#buyConfirm button {
  margin: 10px 8px;
  flex: 1;
  padding: 8px;
  font-weight: 700;
  background: #00D8FF;
  color: #000;
  border: none;
  border-radius: 8px;
}
#infoWindow {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 500px;
  max-height: 80vh;
  background: rgba(0,0,0,0.6);
  border: 2px solid #00D8FF;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 0 20px #00D8FF;
  z-index: 200;
  overflow-y: auto;
}
#infoWindow h2 {
  color: #00D8FF;
  margin-bottom: 10px;
}
#infoWindow ul {
  color: #ccc;
  padding-left: 20px;
}
#infoWindow ul li::before {
  content: "‚Ä¢ ";
  color: #00D8FF;
  font-weight: 600;
}
#infoWindow button {
  width: 100%;
  margin-top: 12px;
  padding: 12px;
  font-size: 18px;
  border: none;
  border-radius: 12px;
  background: #00D8FF;
  color: #000;
  cursor: pointer;
  font-weight: 700;
}
#profileWindow {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 500px;
  max-height: 80vh;
  background: rgba(0,0,0,0.6);
  border: 2px solid #00D8FF;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 0 20px #00D8FF;
  z-index: 200;
  overflow-y: auto;
}
#profileWindow h2 {
  color: #00D8FF;
  margin-bottom: 12px;
  text-align: center;
}
#profileWindow h3 {
  color: #00D8FF;
}
#profileWindow p {
  color: #ccc;
}
#profileWindow button {
  width: 100%;
  margin-top: 12px;
  padding: 12px;
  font-size: 18px;
  border: none;
  border-radius: 12px;
  background: #00D8FF;
  color: #000;
  cursor: pointer;
  font-weight: 700;
}
</style>
</head>
<body>
<header>
  <div class="level-bar">
    <div class="level" data-val="10000">10K</div>
    <div class="level" data-val="50000">50K</div>
    <div class="level" data-val="100000">100K</div>
    <div class="level" data-val="250000">250K</div>
    <div class="level" data-val="500000">500K</div>
    <div class="level" data-val="1000000">1M</div>
    <div class="level" data-val="5000000">5M</div>
  </div>
  <div class="coin-panel">
    <div class="val" id="coinsVal">0</div>
  </div>
</header>
<div class="house"></div>
<div class="controls">
  <button id="startBtn">üè†</button>
  <button class="secondary" id="resetBtn">üîç</button>
</div>

<!-- –ü–∞–Ω–µ–ª—å –∞–ø–≥—Ä–µ–π–¥–æ–≤ (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–æ–π Shop) -->
<div class="upgrade-panel">
  <div class="upgrade" data-key="x2Prize" data-base-price="20000">
    <h3>x2 Prize / x2 Loss</h3>
    <p>Double rewards & penalties</p>
    <div class="price">20,000</div>
  </div>
  <div class="upgrade" data-key="check1" data-base-price="20000">
    <h3>Check 1 Room Only</h3>
    <p>Hunter checks 1 room only (1 min)</p>
    <div class="price">20,000</div>
    <div class="timer" id="check1Timer"></div>
  </div>
</div>

<div class="mining-info">
  <strong>Mining Income:</strong> <span id="miningIncomeVal">0</span>/hr
</div>

<div id="miningShop">
  <h2>Mining Shop</h2>
  <div class="miners-container"></div>
  <button id="closeMiningShop" style="margin-top:12px;width:100%;padding:12px;font-size:18px;border:none;border-radius:12px;background:linear-gradient(90deg,#00D8FF,#00A8FF);color:#000;cursor:pointer;">Close</button>
</div>

<div id="buyConfirm">
  <p id="buyText"></p>
  <div style="display:flex;justify-content:center;">
    <button id="confirmBuy">Buy</button>
    <button id="cancelBuy">Cancel</button>
  </div>
</div>

<div id="infoWindow">
  <h2>How to Play</h2>
  <ul>
    <li>Select a room and then click the üîç button to hunt.</li>
    <li>The hunter searches 2 random rooms (1 if "Check 1 Room" is active).</li>
    <li>If your room is found, you lose coins (shown in red).</li>
    <li>If you evade the hunt, you gain coins (shown in green).</li>
    <li>Buy upgrades or miners to improve your chances and income.</li>
    <li>Claim daily rewards and complete quests for bonus coins.</li>
  </ul>
  <button id="closeInfo">Close</button>
</div>

<div id="profileWindow">
  <h2>Profile</h2>
  <!-- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å -->
  <div style="margin-bottom:16px;padding:16px;background:#2a2a2a;border-radius:12px;box-shadow:0 2px 6px rgba(0,216,255,0.2);">
    <h3 style="margin-bottom:8px;font-size:18px;">Daily Reward</h3>
    <p style="margin-bottom:12px;">Get 30,000 coins once a day!</p>
    <button id="claimDaily" style="width:100%;padding:12px;font-size:16px;border:none;border-radius:12px;background:linear-gradient(90deg,#00D8FF,#00A8FF);color:#000;cursor:pointer;font-weight:700;">Claim Daily</button>
    <p id="dailyStatus" style="margin-top:8px;color:#00D8FF;font-weight:600;text-align:center;"></p>
  </div>
  <!-- –ö–≤–µ—Å—Ç -->
  <div style="margin-bottom:16px;padding:16px;background:#2a2a2a;border-radius:12px;box-shadow:0 2px 6px rgba(0,216,255,0.2);">
    <h3 style="margin-bottom:8px;font-size:18px;">Quest</h3>
    <p style="margin-bottom:12px;">Subscribe to get bonus coins!</p>
    <button id="claimQuest" style="width:100%;padding:12px;font-size:16px;border:none;border-radius:12px;background:linear-gradient(90deg,#00D8FF,#00A8FF);color:#000;cursor:pointer;font-weight:700;">Claim Quest</button>
    <p id="questStatus" style="margin-top:8px;color:#00D8FF;font-weight:600;text-align:center;"></p>
  </div>
  <!-- –ó–∞–∫—Ä—ã—Ç—å -->
  <button id="closeProfile" style="width:100%;padding:14px;font-size:18px;border:none;border-radius:12px;background:linear-gradient(90deg,#00D8FF,#00A8FF);color:#000;cursor:pointer;font-weight:700;">Close</button>
</div>

<div class="bottom-menu">
  <button id="infoBtn" class="secondary">‚Ñπ</button>
  <button id="shopBtn" class="secondary">üõí</button>
  <button id="miningBtn" class="secondary">‚õè</button>
  <button id="profileBtn" class="secondary">üë§</button>
</div>

<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
const rooms = document.querySelector('.house');
for (let i = 0; i < 8; i++) {
  let d = document.createElement('div');
  d.className = 'room';
  d.dataset.idx = i;
  d.textContent = '+';
  rooms.appendChild(d);
}
let selectedRoom = null;
let coins = +localStorage.getItem('coins') || 0;
let maxCoins = +localStorage.getItem('maxCoins') || coins;
const coinsVal = document.getElementById('coinsVal');
let upgrades = JSON.parse(localStorage.getItem('upgrades')) || { x2Prize: 0, check1: 0 };
let check1Expire = +localStorage.getItem('check1Expire') || 0;
let roundInProgress = false;

// –î–∞–Ω–Ω—ã–µ –º–∞–π–Ω–µ—Ä–æ–≤
const minersData = [
  { n: "Miner 1", i: 500, p: 7000 },
  { n: "Miner 2", i: 1788, p: 12000 },
  { n: "Miner 3", i: 2358, p: 15000 },
  { n: "Miner 4", i: 3000, p: 20000 },
  { n: "Miner 5", i: 4500, p: 25000 },
  { n: "Miner 6", i: 5200, p: 30000 },
  { n: "Miner 7", i: 6100, p: 35000 },
  { n: "Miner 8", i: 7200, p: 40000 },
  { n: "Miner 9", i: 8500, p: 45000 },
  { n: "Miner 10", i: 9500, p: 50000 }
];
let minersState = JSON.parse(localStorage.getItem('minersState')) || minersData.map(_ => ({ count: 0 }));
const miningIncomeValEl = document.getElementById('miningIncomeVal');
const minersContainer = document.querySelector('.miners-container');
const miningShop = document.getElementById('miningShop');
const buyConfirm = document.getElementById('buyConfirm');
const buyText = document.getElementById('buyText');
let pendingMiner = null;

// –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–∏—Å–µ–ª
function format(n) {
  return n >= 1e9 ? (n/1e9).toFixed(1).replace(/\\.0$/, '') + 'B' :
         n >= 1e6 ? (n/1e6).toFixed(1).replace(/\\.0$/, '') + 'M' :
         n >= 1e3 ? (n/1e3).toFixed(1).replace(/\\.0$/, '') + 'K' : n;
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
function save() {
  localStorage.setItem('coins', coins);
  localStorage.setItem('maxCoins', maxCoins);
  localStorage.setItem('upgrades', JSON.stringify(upgrades));
  localStorage.setItem('check1Expire', check1Expire);
  localStorage.setItem('minersState', JSON.stringify(minersState));
  localStorage.setItem('lastTime', Date.now());
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç–∞ –º–æ–Ω–µ—Ç
function updCoins(v = 0) {
  coins += v;
  if (coins < 0) coins = 0;
  if (coins > maxCoins) maxCoins = coins;
  coinsVal.textContent = format(coins);
  updLv();
  updUpg();
  updIncome();
  save();
}

// –†–∞—Å—á—ë—Ç –¥–æ—Ö–æ–¥–∞ –≤ —á–∞—Å
function getIncome() {
  return minersState.reduce((sum, m, i) => {
    return sum + (m.count > 0 ? minersData[i].i * Math.pow(2, m.count - 1) : 0);
  }, 0);
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞
function updIncome() {
  miningIncomeValEl.textContent = format(getIncome());
}

// –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –æ—Ñ—Ñ–ª–∞–π–Ω-–¥–æ—Ö–æ–¥–∞
function addOfflineCoins() {
  const last = +localStorage.getItem('lastTime') || Date.now();
  const now = Date.now();
  const diff = (now - last) / 60000; // –º–∏–Ω—É—Ç—ã
  if (diff > 0) {
    updCoins(Math.floor(getIncome()/60 * diff));
  }
  localStorage.setItem('lastTime', now);
}
addOfflineCoins();
setInterval(() => {
  // –î–æ–±–∞–≤–ª—è–µ–º —á–∞—Å—Ç—å –¥–æ—Ö–æ–¥–∞ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
  updCoins(Math.floor(getIncome() / 3600));
}, 1000);

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è (–æ—Ç–º–µ—Ç–∫–∏ –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Å—É–º–º)
function updLv() {
  document.querySelectorAll('.level').forEach(l => {
    l.classList.toggle('active', maxCoins >= +l.dataset.val);
  });
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –∞–ø–≥—Ä–µ–π–¥–æ–≤
function updUpg() {
  document.querySelectorAll('.upgrade').forEach(u => {
    let key = u.dataset.key;
    let base = +u.dataset.basePrice;
    let count = upgrades[key] || 0;
    let price = base * Math.pow(2, count);
    u.querySelector('.price').textContent = format(price);
  });
}

// –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∞–ø–≥—Ä–µ–π–¥
document.querySelectorAll('.upgrade').forEach(u => {
  u.onclick = () => {
    let key = u.dataset.key;
    let base = +u.dataset.basePrice;
    let count = upgrades[key] || 0;
    let price = base * Math.pow(2, count);
    if (coins >= price) {
      upgrades[key] = count + 1;
      updCoins(-price);
      if (key === "check1") {
        check1Expire = Date.now() + 60000; // 1 –º–∏–Ω—É—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—è
      }
      save();
    } else {
      alert("Not enough coins!");
    }
  };
});

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –∞–ø–≥—Ä–µ–π–¥–∞ Check 1 Room
function updCheck() {
  const el = document.getElementById("check1Timer");
  if (check1Expire > Date.now()) {
    el.textContent = "‚è≥ " + Math.floor((check1Expire - Date.now())/1000) + "s";
  } else {
    el.textContent = "";
  }
}
setInterval(updCheck, 1000);

// –í—ã–±–æ—Ä –∫–æ–º–Ω–∞—Ç—ã
document.querySelectorAll('.room').forEach(r => {
  r.onclick = () => {
    if (roundInProgress) return;
    document.querySelectorAll('.room').forEach(x => x.classList.remove('selected'));
    r.classList.add('selected');
    selectedRoom = +r.dataset.idx;
  };
});

// –ö–Ω–æ–ø–∫–∞ Start: —Å–±—Ä–æ—Å –ø—Ä–æ—à–ª—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
document.getElementById('startBtn').onclick = () => {
  if (selectedRoom == null) {
    alert('Pick a room first!');
    return;
  }
  document.querySelectorAll('.room').forEach(r => {
    r.classList.remove('found', 'safe');
  });
};

// –ö–Ω–æ–ø–∫–∞ Reset (üîç): –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Ö–æ—Ç—É
document.getElementById('resetBtn').onclick = () => {
  if (selectedRoom == null) {
    alert('Pick a room first!');
    return;
  }
  roundInProgress = true;
  const numPicks = (check1Expire > Date.now()) ? 1 : 2;
  let picks = [...Array(8).keys()].sort(() => 0.5 - Math.random()).slice(0, numPicks);
  document.querySelectorAll('.room').forEach(r => r.classList.remove('found', 'safe', 'highlight'));
  let delay = 0;
  picks.forEach(i => {
    let room = document.querySelector(`.room[data-idx="${i}"]`);
    setTimeout(() => {
      room.classList.add('highlight');
    }, delay);
    setTimeout(() => {
      room.classList.remove('highlight');
    }, delay + 600);
    delay += 700;
  });
  setTimeout(() => {
    let prize = 1000, loss = -2000;
    if (upgrades.x2Prize > 0) {
      prize *= Math.pow(2, upgrades.x2Prize);
      loss *= Math.pow(2, upgrades.x2Prize);
    }
    if (picks.includes(selectedRoom)) {
      // –ü–æ—Ç–µ—Ä—è–ª–∏
      const room = document.querySelector(`.room[data-idx="${selectedRoom}"]`);
      room.classList.add('found');
      updCoins(loss);
    } else {
      // –í—ã–∏–≥—Ä–∞–ª–∏
      const room = document.querySelector(`.room[data-idx="${selectedRoom}"]`);
      room.classList.add('safe');
      updCoins(prize);
    }
    selectedRoom = null;
    document.querySelectorAll('.room').forEach(r => r.classList.remove('selected'));
    roundInProgress = false;
  }, delay + 700);
};

// –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞ –º–∞–π–Ω–µ—Ä–æ–≤
function renderMiners() {
  minersContainer.innerHTML = "";
  minersData.forEach((m, i) => {
    let st = minersState[i];
    let price = m.p * Math.pow(2, st.count);
    let income = st.count > 0 ? m.i * Math.pow(2, st.count - 1) : 0;
    let card = document.createElement('div');
    card.className = 'miner-card';
    card.innerHTML = '<h3>' + m.n + '</h3><div class="income">Profit/hr: <span class="income-val">+' + format(income) + '</span></div><div class="bottom"><span class="lvl">Lvl ' + st.count + '</span><span class="price">' + format(price) + '</span></div>';
    card.onclick = () => {
      if (coins >= price) {
        pendingMiner = i;
        buyText.textContent = `Buy ${m.n} for ${format(price)}?`;
        buyConfirm.classList.add('show');
      } else {
        alert("Not enough coins!");
      }
    };
    minersContainer.appendChild(card);
  });
}

// –û—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å –º–∞–π–Ω–∏–Ω–≥-—à–æ–ø
document.getElementById('miningBtn').onclick = () => {
  miningShop.style.display = 'block';
  renderMiners();
};
document.getElementById('closeMiningShop').onclick = () => {
  miningShop.style.display = 'none';
};

// –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–º–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ –º–∞–π–Ω–µ—Ä–∞
document.getElementById('confirmBuy').onclick = () => {
  if (pendingMiner === null) return;
  let i = pendingMiner;
  let m = minersData[i];
  let st = minersState[i];
  let price = m.p * Math.pow(2, st.count);
  if (coins >= price) {
    coins -= price;
    st.count++;
    updCoins(0);
    save();
    renderMiners();
  } else {
    alert("Not enough coins!");
  }
  pendingMiner = null;
  buyConfirm.classList.remove('show');
};
document.getElementById('cancelBuy').onclick = () => {
  pendingMiner = null;
  buyConfirm.classList.remove('show');
};

// –ü—Ä–æ—Ñ–∏–ª—å (Daily/Quest)
const profileWindowEl = document.getElementById('profileWindow');
document.getElementById('profileBtn').onclick = () => profileWindowEl.style.display = 'block';
document.getElementById('closeProfile').onclick = () => profileWindowEl.style.display = 'none';

let questClaimed = localStorage.getItem('questClaimed') === 'true';
let lastDaily = +localStorage.getItem('lastDaily') || 0;
const questStatusEl = document.getElementById('questStatus');
const dailyStatusEl = document.getElementById('dailyStatus');

function updateQuestStatus() {
  questStatusEl.textContent = questClaimed ? "‚úÖ Completed" : "‚ùå Not claimed";
}
function updateDailyStatus() {
  let now = Date.now();
  let nextAvailable = lastDaily + 24*60*60*1000;
  if (now >= nextAvailable) {
    dailyStatusEl.textContent = "üí∞ Available!";
  } else {
    let diff = nextAvailable - now;
    let hours = Math.floor(diff / (1000*60*60));
    let minutes = Math.floor((diff % (1000*60*60)) / (1000*60));
    dailyStatusEl.textContent = `Next in ${hours}h ${minutes}m`;
  }
}
setInterval(updateDailyStatus, 60000);
updateDailyStatus();
updateQuestStatus();

// –ö–Ω–æ–ø–∫–∏ Daily/Quest
document.getElementById('claimQuest').onclick = () => {
  if (questClaimed) {
    alert("Quest already claimed!");
  } else {
    updCoins(50000);
    questClaimed = true;
    localStorage.setItem('questClaimed', 'true');
    updateQuestStatus();
  }
};
document.getElementById('claimDaily').onclick = () => {
  let now = Date.now();
  if (now - lastDaily < 24*60*60*1000) {
    alert("Daily reward already claimed!");
  } else {
    updCoins(30000);
    lastDaily = now;
    localStorage.setItem('lastDaily', now);
    updateDailyStatus();
  }
};

// –ö–Ω–æ–ø–∫–∏ Info –∏ Shop
document.getElementById('infoBtn').onclick = () => {
  document.getElementById('infoWindow').style.display = 'block';
};
document.getElementById('closeInfo').onclick = () => {
  document.getElementById('infoWindow').style.display = 'none';
};
document.getElementById('shopBtn').onclick = () => {
  let panel = document.querySelector('.upgrade-panel');
  panel.style.display = (panel.style.display === 'none' ? 'flex' : 'none');
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI
coinsVal.textContent = format(coins);
updLv();
updUpg();
updIncome();
updCheck();
</script>
</body>
</html>














